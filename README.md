# FBA_E.coli_M4_iclR
Metabolic models of E. coli mutant strains
# -*- coding: utf-8 -*-
"""03-integrate-fluxes glpk DH.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1Nl-l1iW0OdPqTGgmOdVJCcoTMuNJUPWi

# Exercise FBA

Mutant strains and measured the production/consumption of Succinic Acid, Acetate, Malate, Glycerol and growth, for each strain. We will use modelling to explore differences in the intracellular fluxes occuring in each strain.

**Specifically, we would like to compare the M4-iclr and M4-iclr/pck strains.**

**Whenever there is a label that says: "%%%% Question", you need to answer/do something. It means you should either**:
- add a text box and write what you think
- add or edit a code box to code what you think.
- remember if you modify a cell, cells that were run before it aren't affected, however all cells run after it, are. if you modify a cell, you have to re-run any other cells that depend on its output, to see the change in those cells

**To turn in your work**, save your resulting notebook and and any files you use to answer questions, and turn them in.

# Prepare models

## - Downloading the E. coli core model and installing cobrapy

Cobra(py) is the python module that we'll be using to model _E. coli_'s intracellular metabolism. Please see the documentation at https://cobrapy.readthedocs.io/en/latest/
"""

# Commented out IPython magic to ensure Python compatibility.
# # prepare cobra
# %%capture
# 
# 
# !pip install cobra
# from cobra.io import read_sbml_model, load_json_model
# import cobra

# Commented out IPython magic to ensure Python compatibility.
# %%capture
# # download the ecoli core model from BiGG database, save in the temp dir "model"
# !wget http://bigg.ucsd.edu/static/models/e_coli_core.xml -P models
# 
# # do the same for the gemone-scale model
# !wget http://bigg.ucsd.edu/static/models/iJO1366.json  -P models

from os import name
# load model
model = read_sbml_model('models/e_coli_core.xml')
[print(gene.reactions) for gene in model.genes.query('pta','name')]

model

model.reactions[5] #Los límites del flujo son -1000 y 1000, indicando que es una reacción reversible.

model.metabolites.get_by_id("atp_c")

model.reactions.EX_glc__D_e

pgi = model.reactions.get_by_id("PGI")
print(pgi.reaction)

pyk = model.reactions.get_by_id("PYK")
print(pyk.lower_bound,"< pyk <", pyk.upper_bound)

"""## - Add Glycerol metabolism

Glycerol metabolism is not included in the "core" model. We have to add the reactions that allow glycerol to enter the system.  Let's add the necessary metabolites and reactions.
"""

# we will be using the Reaction and Metabolite classes from the cobra module+
from cobra import Reaction, Metabolite

# create metabolites (example included ignore the periplasm)

glyc_e = Metabolite(id='glyc_e', compartment='e', formula='C3H8O3')
glyc_c = Metabolite(id='glyc_c', compartment='c', formula='C3H8O3')
glyc3p_c = Metabolite(id='glyc3p_c', compartment='c')

# create reactions

# Exchange reaction (created to allow glycerol appear in extracellular matrix)
model.add_boundary(glyc_e)

# create a pseudo transport reaction that takes extracellular glycerol and imports it
GLYCt = Reaction('GLYCt')
GLYCt.add_metabolites({glyc_e: -1, glyc_c: 1})

# create glycerol kinase
GLYK = Reaction('GLYK')
GLYK.add_metabolites({glyc_c:-1, model.metabolites.atp_c:-1, glyc3p_c:1, model.metabolites.h_c:1, model.metabolites.adp_c:1})

### other reactions
G3PD2 = Reaction('G3PD2')
G3PD2.add_metabolites({glyc3p_c:-1, model.metabolites.nadp_c:-1, model.metabolites.dhap_c:1, model.metabolites.h_c:1, model.metabolites.nadph_c:1})

#add reactions to model
model.add_reactions([GLYCt, GLYK, G3PD2])

# confirm reactions
model.reactions.G3PD2

print(len(model.metabolites))



"""## - Correcting default exchange fluxes.
Setting the correct inputs to the model. We dont want our models to incorporate any additional carbon/nutrients that would lead to false predictions.
"""

# set the correct "consumption" values for other compounds.
# if we assume carbon limitation we only need to limit uptake of carbon sources

# set "medium"
medium = model.medium
medium['EX_glc__D_e'] = 0
model.medium = medium

# print out "medium"
model.medium

model.metabolites.get_by_id("ac_c")

"""## - Creating strain/experiment specific models

### M4
"""

# create a mutant
M4 = model.copy()
M4.id = "M4"
M4.reactions.SUCDi.knock_out()

# ack   M4.genes.query('ack','name')[0]
M4.reactions.ACKr.knock_out()

# pta
M4.reactions.PTAr.knock_out()

# ppc is not expressed in the experimental conditions
M4.reactions.PPC.knock_out()

# if I delete these two reactions, acetate production is infeasible, so we have
# to add at least one pathway
gs_model = load_json_model('models/iJO1366.json')
M4.add_reactions([gs_model.reactions.ALDD2x, gs_model.reactions.ALDD2y])

# pox
# don't need to delete since it's not in the model

#
M4.reactions.MALt2_2.lower_bound = -1000
M4.reactions.MALt2_2.upper_bound =  1000

# Formate and ethanol reactions are not actived in aerobic conditions. These
# these enzyme genes are not deleted but not are expressed.

M4.reactions.FORt2.lower_bound = 0
M4.reactions.FORt2.upper_bound = 0
M4.reactions.ETOHt2r.lower_bound = 0
M4.reactions.ETOHt2r.upper_bound = 0

#Cambiar la direccionalidad de la PCK para sea reversible PEP <--> OAA
M4.reactions.PPCK.upper_bound = 1000
M4.reactions.PPCK.lower_bound = -1000

# #Cambiar la direccionalidad de la PPC para sea reversible PEP <--> OAA
# M4.reactions.PPC.upper_bound = 1000
# M4.reactions.PPC.lower_bound = -1000

r = M4.reactions.PPC
print(r.lower_bound,"< ", r.id, " <", r.upper_bound)

"""### M4 iclr

"icrl" means ICL Repressor has been deleted.

**Question 1**: What does it mean to delete a repressor in a flux balance model? What mathematical assumptions would we have to make to make biologically relevant simulations? How would we model this deletion?

Deleting a repressor _should_ encourage flux through a reaction...

For now let's leave this alone...

"""

# create mutant copy
M4iclr = M4.copy()
M4iclr.id = "M4iclr"

# save model
cobra.io.save_json_model(M4iclr, "model_M4icrl_no_rates.json")

"""### **M4 iclR/pB-pck**

"""

# create mutant copy
M4iclr_pck = M4iclr.copy()
M4iclr_pck.id = "M4iclr_pck"


# pck constituive
# M4iclr_pck.reactions.PPCK.lower_bound = -40
# M4iclr_pck.reactions.PPCK.upper_bound = -3

# pck constituive
M4iclr_pck.reactions.PPCK.lower_bound = -1000
M4iclr_pck.reactions.PPCK.upper_bound = 1000

# M4iclr_pck.reactions.PPC.lower_bound = -1000
# M4iclr_pck.reactions.PPC.upper_bound = 1000

# save model
cobra.io.save_json_model(M4iclr_pck, "model_M4iclr_pck_no_rates.json")

"""### **M4-iclR/pB-K-pck+pB-A-glpK**

"""

# create mutant copy
M4iclr_pck_glpk_flask = M4iclr_pck.copy()
M4iclr_pck_glpk_flask.id = "M4iclr_pck_glpk_flask"

M4iclr_pck_glpk_bio_pure = M4iclr_pck.copy()
M4iclr_pck_glpk_bio_pure.id = "M4iclr_pck_glpk_bio_pure"

M4iclr_pck_glpk_bio_raw = M4iclr_pck.copy()
M4iclr_pck_glpk_bio_raw.id = "M4iclr_pck_glpk_bio_raw"

"""# Inserting experimental flux measurements for each strain

Here we need take into account two steps before we get functional models.

1. When we insert the specific rates into the model, **we multiply them by a scaling factor**. Why? The model has a "maintenance" reaction (that represents the basal energy consumed to sustain life without growth). This maintenance value is calculated assuming 10 mmol Glucose/h/gCDW.  We scale all of our fluxes so that the carbon input is roughly consistent with this assumption.

2. Second, after we insert our bounds we **may find that the model is infeasible**. If this happens, the model cannot stoichiometrically sustain the defined fluxes. Thus one solution is to **relax the imposed flux bounds** to a certain percentage error. In this case both our sets of experimental data are feasible! :) If they weren't, you'd have to expand the bounds slowly until you find a working distribution.

## M4 iclr insert rates
"""

# insert the specific rates
error_factor = 0  # choose value from 0 to 1
multipling_factor = 60/(3 * 1.743)

# production fluxes

M4iclr.reactions.EX_ac_e.lower_bound = 0.1295 * (1 - error_factor) * multipling_factor
M4iclr.reactions.EX_ac_e.upper_bound = 0.1295 * (1 + error_factor) * multipling_factor

M4iclr.reactions.BIOMASS_Ecoli_core_w_GAM.lower_bound = 0.0419 * (1 - error_factor) * multipling_factor
M4iclr.reactions.BIOMASS_Ecoli_core_w_GAM.upper_bound = 0.0419 * (1 + error_factor) * multipling_factor

M4iclr.reactions.EX_succ_e.lower_bound = 0.2706 * (1 - error_factor) * multipling_factor
M4iclr.reactions.EX_succ_e.upper_bound = 0.2706 * (1 + error_factor) * multipling_factor

M4iclr.reactions.EX_mal__L_e.lower_bound = -0.0096 * (1 + error_factor) * multipling_factor
M4iclr.reactions.EX_mal__L_e.upper_bound = -0.0096 * (1 - error_factor) * multipling_factor

# consumption fluxes

M4iclr.reactions.EX_glyc_e.lower_bound = -1.743 * (1 + error_factor) * multipling_factor
M4iclr.reactions.EX_glyc_e.upper_bound = -1.743 * (1 - error_factor) * multipling_factor

sol = M4iclr.optimize() # if there is a solution, the model is feasible

# Antonio says there wasn't any secondary metabolite production other than the ones measured,
# remove this production of secondary metabolites and produce as much CO2 as possible
# In this case, because there are no extra ways for C to enter the system, optimizing co2 and setting the rest of the medium to 0 are equivalent.
M4iclr.objective = {model.reactions.EX_co2_e: 1}

# Antonio said there needs to be flux in MDH!
M4iclr.reactions.MDH.lower_bound = 1

# Parsimonious FBA (often written pFBA) is a specific kind of FBA that finds a flux distribution which gives the optimal growth rate, and at the same time **minimizes the total sum of flux**. We will use this method to simulate our intracellular metabolism.
# calculate parsimonious FBA flux distribution
pfba_M4iclr = cobra.flux_analysis.pfba(M4iclr)
M4iclr.summary(solution=pfba_M4iclr)

"""## **M4 iclr / pck insert rates**
Do the same thing for the second strain

"""

# insert the specific rates
error_factor = 0  # choose value from 0 to 1
multipling_factor = 60/(3 * 3.285)


# production fluxes

M4iclr_pck.reactions.EX_ac_e.lower_bound = 1.049 * (1 - error_factor) * multipling_factor
M4iclr_pck.reactions.EX_ac_e.upper_bound = 1.049 * (1 + error_factor) * multipling_factor

M4iclr_pck.reactions.BIOMASS_Ecoli_core_w_GAM.lower_bound = 0.043 * (1 - error_factor) * multipling_factor
M4iclr_pck.reactions.BIOMASS_Ecoli_core_w_GAM.upper_bound = 0.043 * (1 + error_factor) * multipling_factor

M4iclr_pck.reactions.EX_succ_e.lower_bound = 0.351 * (1 - error_factor) * multipling_factor
M4iclr_pck.reactions.EX_succ_e.upper_bound = 0.351 * (1 + error_factor) * multipling_factor

M4iclr_pck.reactions.EX_mal__L_e.lower_bound = 0.895 * (1 - error_factor) * multipling_factor
M4iclr_pck.reactions.EX_mal__L_e.upper_bound = 0.895 * (1 + error_factor) * multipling_factor

# consumption fluxes

M4iclr_pck.reactions.EX_glyc_e.lower_bound = -3.285 * (1 + error_factor) * multipling_factor
M4iclr_pck.reactions.EX_glyc_e.upper_bound = -3.285 * (1 - error_factor) * multipling_factor

M4iclr_pck.objective = {model.reactions.EX_co2_e: 1}

# calculate parsimonious FBA flux distribution
pfba_M4iclr_pck = cobra.flux_analysis.pfba(M4iclr_pck)

M4iclr_pck.summary(solution=pfba_M4iclr_pck)



M4iclr.metabolites.oaa_c.summary(solution=pfba_M4iclr_pck)

"""## **M4iclr_pck_glpk**

### insert bio_raw
"""

# insert the specific rates
error_factor = 0  # choose value from 0 to 1
multipling_factor = 60/(3 * 2.529)


# production fluxes

M4iclr_pck_glpk_bio_raw.reactions.EX_ac_e.lower_bound = 0.2899 * (1 - error_factor) * multipling_factor
M4iclr_pck_glpk_bio_raw.reactions.EX_ac_e.upper_bound = 0.2899 * (1 + error_factor) * multipling_factor

M4iclr_pck_glpk_bio_raw.reactions.BIOMASS_Ecoli_core_w_GAM.lower_bound = 0.0195 * (1 - error_factor) * multipling_factor
M4iclr_pck_glpk_bio_raw.reactions.BIOMASS_Ecoli_core_w_GAM.upper_bound = 0.0195 * (1 + error_factor) * multipling_factor

M4iclr_pck_glpk_bio_raw.reactions.EX_succ_e.lower_bound = 0.0266 * (1 - error_factor) * multipling_factor
M4iclr_pck_glpk_bio_raw.reactions.EX_succ_e.upper_bound = 0.0266 * (1 + error_factor) * multipling_factor

M4iclr_pck_glpk_bio_raw.reactions.EX_mal__L_e.lower_bound = 1.6167 * (1 - error_factor) * multipling_factor
M4iclr_pck_glpk_bio_raw.reactions.EX_mal__L_e.upper_bound = 1.6167 * (1 + error_factor) * multipling_factor

# consumption fluxes

M4iclr_pck_glpk_bio_raw.reactions.EX_glyc_e.lower_bound = -2.529 * (1 + error_factor) * multipling_factor
M4iclr_pck_glpk_bio_raw.reactions.EX_glyc_e.upper_bound = -2.529 * (1 - error_factor) * multipling_factor

M4iclr_pck_glpk_bio_raw.objective = {M4iclr_pck_glpk_bio_raw.reactions.EX_co2_e: 1}

pfba_M4iclr_pck_glpk_bio_raw = cobra.flux_analysis.pfba(M4iclr_pck_glpk_bio_raw)
M4iclr_pck_glpk_bio_raw.summary(solution= pfba_M4iclr_pck_glpk_bio_raw)

M4iclr_pck_glpk_bio_raw.metabolites.get_by_id("co2_e").reactions

"""### insert bio pure"""

# insert the specific rates
error_factor = 0  # choose value from 0 to 1
multipling_factor = 60/(3 * 2.799)


# production fluxes

M4iclr_pck_glpk_bio_pure.reactions.EX_ac_e.lower_bound = 0.2470 * (1 - error_factor) * multipling_factor
M4iclr_pck_glpk_bio_pure.reactions.EX_ac_e.upper_bound = 0.2470 * (1 + error_factor) * multipling_factor

M4iclr_pck_glpk_bio_pure.reactions.BIOMASS_Ecoli_core_w_GAM.lower_bound = 0.0217 * (1 - error_factor) * multipling_factor
M4iclr_pck_glpk_bio_pure.reactions.BIOMASS_Ecoli_core_w_GAM.upper_bound = 0.0217 * (1 + error_factor) * multipling_factor

M4iclr_pck_glpk_bio_pure.reactions.EX_succ_e.lower_bound = 0.0014 * (1 - error_factor) * multipling_factor
M4iclr_pck_glpk_bio_pure.reactions.EX_succ_e.upper_bound = 0.0014 * (1 + error_factor) * multipling_factor

M4iclr_pck_glpk_bio_pure.reactions.EX_mal__L_e.lower_bound = 1.4129 * (1 - error_factor) * multipling_factor
M4iclr_pck_glpk_bio_pure.reactions.EX_mal__L_e.upper_bound = 1.4129 * (1 + error_factor) * multipling_factor

# consumption fluxes

M4iclr_pck_glpk_bio_pure.reactions.EX_glyc_e.lower_bound = -2.799 * (1 + error_factor) * multipling_factor
M4iclr_pck_glpk_bio_pure.reactions.EX_glyc_e.upper_bound = -2.799 * (1 - error_factor) * multipling_factor

M4iclr_pck_glpk_bio_pure.objective = {model.reactions.EX_co2_e: 1}


pfba_M4iclr_pck_glpk_bio_pure = cobra.flux_analysis.pfba(M4iclr_pck_glpk_bio_pure)
M4iclr_pck_glpk_bio_pure.summary(solution= pfba_M4iclr_pck_glpk_bio_pure)

"""### insert flask"""

# insert the specific rates
error_factor = 0  # choose value from 0 to 1
multipling_factor = 60/(3 * 2.665)


# production fluxes

M4iclr_pck_glpk_flask.reactions.EX_ac_e.lower_bound = 0.4342 * (1 - error_factor) * multipling_factor
M4iclr_pck_glpk_flask.reactions.EX_ac_e.upper_bound = 0.4342 * (1 + error_factor) * multipling_factor

M4iclr_pck_glpk_flask.reactions.BIOMASS_Ecoli_core_w_GAM.lower_bound = 0.0327 * (1 - error_factor) * multipling_factor
M4iclr_pck_glpk_flask.reactions.BIOMASS_Ecoli_core_w_GAM.upper_bound = 0.0327 * (1 + error_factor) * multipling_factor

M4iclr_pck_glpk_flask.reactions.EX_succ_e.lower_bound = 0.1848 * (1 - error_factor) * multipling_factor
M4iclr_pck_glpk_flask.reactions.EX_succ_e.upper_bound = 0.1848 * (1 + error_factor) * multipling_factor

M4iclr_pck_glpk_flask.reactions.EX_mal__L_e.lower_bound = 0.7702 * (1 - error_factor) * multipling_factor
M4iclr_pck_glpk_flask.reactions.EX_mal__L_e.upper_bound = 0.7702 * (1 + error_factor) * multipling_factor

# consumption fluxes

M4iclr_pck_glpk_flask.reactions.EX_glyc_e.lower_bound = -2.665 * (1 + error_factor) * multipling_factor
M4iclr_pck_glpk_flask.reactions.EX_glyc_e.upper_bound = -2.665 * (1 - error_factor) * multipling_factor

M4iclr_pck_glpk_flask.objective = {model.reactions.EX_co2_e: 1}


pfba_M4iclr_pck_glpk_flask = cobra.flux_analysis.pfba(M4iclr_pck_glpk_flask)
M4iclr_pck_glpk_flask.summary(solution= pfba_M4iclr_pck_glpk_flask)

"""# Visualize

**Visualization in Escher-FBA**

Download "map_M4_aldd.json" for the map.

there are two models:f M4iclR.json and M4iclr_pck.json.

you can load the fluxes generated below



"""

# with model M4iclR
pfba_M4iclr.fluxes.to_csv('M4iclr_flux.csv')

# with model M4iclR_pck
pfba_M4iclr_pck.fluxes.to_csv('M4iclr_pck_flux.csv')
pfba_M4iclr_pck_glpk_flask.fluxes.to_csv('M4iclr_pck_glpk_flask_flux.csv')
pfba_M4iclr_pck_glpk_bio_pure.fluxes.to_csv('M4iclr_pck_glpk_bio_pure_flux.csv')
pfba_M4iclr_pck_glpk_bio_raw.fluxes.to_csv('M4iclr_pck_glpk_bio_raw_flux.csv')

# save model
pfba_M4iclr.fluxes.to_json("M4iclr.json")
pfba_M4iclr_pck.fluxes.to_json("M4iclr_pck.json")
pfba_M4iclr_pck_glpk_flask.fluxes.to_json("M4iclr_pck_glpk_flask.json")
pfba_M4iclr_pck_glpk_bio_pure.fluxes.to_json("M4iclr_pck_glpk_flask.json")
pfba_M4iclr_pck_glpk_bio_raw.fluxes.to_json("M4iclr_pck_glpk_flask.json")

cobra.io.save_json_model(M4iclr, "M4iclr.json")
cobra.io.save_json_model(M4iclr_pck, "M4iclr_pck.json")
cobra.io.save_json_model(M4iclr_pck_glpk_flask, "M4iclr_pck_glpk_flask.json")
cobra.io.save_json_model(M4iclr_pck_glpk_bio_pure, "M4iclr_pck_glpk_bio_pure.json")
cobra.io.save_json_model(M4iclr_pck_glpk_bio_raw, "M4iclr_pck_glpk_bio_raw.json")

"""# Compare key metabolite nodes

## ATP
"""

from IPython.display import display

display("M4iclr", M4iclr.metabolites.atp_c.summary(solution=pfba_M4iclr))
display("M4iclr_pck", M4iclr_pck.metabolites.atp_c.summary(solution=pfba_M4iclr_pck))
display("M4iclr_pck_glpk_flask", M4iclr_pck_glpk_flask.metabolites.atp_c.summary(solution=pfba_M4iclr_pck_glpk_flask))
display("M4iclr_pck_glpk_bio_pure", M4iclr_pck_glpk_bio_pure.metabolites.atp_c.summary(solution=pfba_M4iclr_pck_glpk_bio_pure))
display("M4iclr_pck_glpk_bio_raw", M4iclr_pck_glpk_bio_raw.metabolites.atp_c.summary(solution=pfba_M4iclr_pck_glpk_bio_raw))

"""## NADH"""

from IPython.display import display

display("M4iclr", M4iclr.metabolites.nadh_c.summary(solution=pfba_M4iclr))
display("M4iclr_pck", M4iclr_pck.metabolites.nadh_c.summary(solution=pfba_M4iclr_pck))
display("M4iclr_pck_glpk_flask", M4iclr_pck_glpk_flask.metabolites.nadh_c.summary(solution=pfba_M4iclr_pck_glpk_flask))
display("M4iclr_pck_glpk_bio_pure", M4iclr_pck_glpk_bio_pure.metabolites.nadh_c.summary(solution=pfba_M4iclr_pck_glpk_bio_pure))
display("M4iclr_pck_glpk_bio_raw", M4iclr_pck_glpk_bio_raw.metabolites.nadh_c.summary(solution=pfba_M4iclr_pck_glpk_bio_raw))

"""## O2"""

from IPython.display import display

display("M4iclr", M4iclr.metabolites.o2_c.summary(solution=pfba_M4iclr))
display("M4iclr_pck", M4iclr_pck.metabolites.o2_c.summary(solution=pfba_M4iclr_pck))
display("M4iclr_pck_glpk_flask", M4iclr_pck_glpk_flask.metabolites.o2_c.summary(solution=pfba_M4iclr_pck_glpk_flask))
display("M4iclr_pck_glpk_bio_pure", M4iclr_pck_glpk_bio_pure.metabolites.o2_c.summary(solution=pfba_M4iclr_pck_glpk_bio_pure))
display("M4iclr_pck_glpk_bio_raw", M4iclr_pck_glpk_bio_raw.metabolites.o2_c.summary(solution=pfba_M4iclr_pck_glpk_bio_raw))

"""# Perform flux variability analysis for each strain

Flux Variability calculates the range of values that a reaction can have. It can be useful to see alternative fluxes that our cell could have.

The column "Range" will tell us the maximum and minimum fluxes each reaction can have.
"""

from cobra.flux_analysis import flux_variability_analysis
from cobra.summary import MetaboliteSummary

# perform flux variability analysis on all models
models = [M4iclr, M4iclr_pck, M4iclr_pck_glpk_flask, M4iclr_pck_glpk_bio_pure, M4iclr_pck_glpk_bio_raw]

fva_res = {}
for i, model in enumerate(models[0:4]):
  print(model.id)
  fva_res[model.id] =  flux_variability_analysis(model,loopless=True,
                                                                  fraction_of_optimum=1, # can be [0-1]
                                                                  pfba_factor=1.0000) # can be >= 1

# taking previously calculated "fva_M4iclr", get summary of only exchange fluxes
# M4iclr.summary(fva=fva_M4iclr) # not interesting because exchange fluxes are fixed.

for i, model in enumerate(models[0:4]):
  display(model.id, MetaboliteSummary(metabolite=model.metabolites.get_by_id("atp_c"), model=model, fva=fva_res[model.id]))

# Check if 'PPCK' is in the pfba_M4iclr fluxes
if 'PPCK' in pfba_M4iclr.fluxes:
    print("'PPCK' found in pfba_M4iclr fluxes.")
    # Try to directly print the flux value
    print("PPCK flux in M4iclr:", pfba_M4iclr.fluxes['PPCK'])
else:
    print("'PPCK' not found in pfba_M4iclr fluxes.")

# Check if 'PPCK' is in the M4iclr model reactions
if 'PPCK' in [r.id for r in M4iclr.reactions]:
    print("'PPCK' found in M4iclr model reactions.")
else:
    print("'PPCK' not found in M4iclr model reactions.")
